<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Faktura {{ invoice.invoice_number }}</title>
    <style>
        {% include 'css/invoice.css' %}

        /* Override colors for received invoices */
        .invoice-header {
            border-bottom-color: #059669;
        }
        .company-name, .invoice-title h1 {
            color: #047857;
        }
        .items-table th {
            background: #047857;
        }
        .totals-table .total-row {
            background: #047857;
        }
        .payment-section {
            background: #ecfdf5;
            border-color: #6ee7b7;
        }
        .payment-details h3 {
            color: #047857;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="invoice-header">
        <div class="company-info">
            <div class="company-name">{{ seller.first_name }} {{ seller.last_name }}</div>
            <div class="company-details">
                {% if seller.address %}<p>{{ seller.address }}</p>{% endif %}
                {% if seller.country %}<p>{{ seller.country }}</p>{% endif %}
                {% if seller.email %}<p>Email: {{ seller.email }}</p>{% endif %}
                {% if seller.phone %}<p>Tel: {{ seller.phone }}</p>{% endif %}
                {% if seller.bank_account_iban %}
                    <p><strong>IBAN:</strong> {{ seller.bank_account_iban }}</p>
                {% elif seller.bank_account %}
                    <p><strong>Ucet:</strong> {{ seller.bank_account }}</p>
                {% endif %}
            </div>
        </div>
        <div class="invoice-title">
            <h1>FAKTURA</h1>
            <div class="invoice-number">{{ invoice.invoice_number }}</div>
            <div class="invoice-meta">
                <p><strong>Datum vystaveni:</strong> {{ invoice.issue_date | format_date_cs }}</p>
                <p><strong>Datum splatnosti:</strong> {{ invoice.due_date | format_date_cs }}</p>
                {% if invoice.period_from and invoice.period_to %}
                    <p><strong>Obdobi:</strong> {{ invoice.period_from | format_date_cs }} - {{ invoice.period_to | format_date_cs }}</p>
                {% endif %}
                {% if invoice.paid_at %}
                    <p><strong>Uhrazeno:</strong> {{ invoice.paid_at | format_date_cs }}</p>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Parties -->
    <div class="parties">
        <div class="party-box">
            <h3>Dodavatel (Obchodnik)</h3>
            <div class="party-name">{{ seller.first_name }} {{ seller.last_name }}</div>
            <div class="party-details">
                {% if seller.seller_code %}<p>Kod obchodnika: {{ seller.seller_code }}</p>{% endif %}
                {% if seller.address %}<p>{{ seller.address }}</p>{% endif %}
                {% if seller.email %}<p>Email: {{ seller.email }}</p>{% endif %}
                {% if seller.phone %}<p>Tel: {{ seller.phone }}</p>{% endif %}
            </div>
        </div>
        <div class="party-box">
            <h3>Odberatel</h3>
            <div class="party-name">{{ platform.company_name or 'Webomat s.r.o.' }}</div>
            <div class="party-details">
                {% if platform.street %}<p>{{ platform.street }}</p>{% endif %}
                {% if platform.city or platform.postal_code %}
                    <p>{{ platform.postal_code }} {{ platform.city }}</p>
                {% endif %}
                {% if platform.ico %}<p>ICO: {{ platform.ico }}</p>{% endif %}
                {% if platform.dic %}<p>DIC: {{ platform.dic }}</p>{% endif %}
                {% if platform.email %}<p>Email: {{ platform.email }}</p>{% endif %}
            </div>
        </div>
    </div>

    <!-- Items -->
    <table class="items-table">
        <thead>
            <tr>
                <th>Popis</th>
                <th class="amount-col">Castka</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    {% if invoice.invoice_type == 'commission' %}
                        Provize za zprostredkovani
                    {% elif invoice.invoice_type == 'service' %}
                        {{ invoice.vendor_name or 'Sluzby' }}
                    {% else %}
                        {{ invoice.description_text or 'Fakturovane sluzby' }}
                    {% endif %}
                    {% if invoice.period_from and invoice.period_to %}
                        <br><small>Obdobi: {{ invoice.period_from | format_date_cs }} - {{ invoice.period_to | format_date_cs }}</small>
                    {% endif %}
                </td>
                <td class="amount-col">{{ invoice.amount_total | format_currency }} {{ invoice.currency }}</td>
            </tr>
        </tbody>
    </table>

    <!-- Totals -->
    <div class="totals-section">
        <table class="totals-table">
            <tr class="total-row">
                <td>Celkem k vyplaceni</td>
                <td>{{ invoice.amount_to_payout or invoice.amount_total | format_currency }} {{ invoice.currency }}</td>
            </tr>
        </table>
    </div>

    <!-- Payment info -->
    <div class="payment-section">
        <div class="payment-details">
            <h3>Platebni udaje dodavatele</h3>
            <div class="payment-info">
                {% if seller.bank_account_iban %}
                    <p><strong>IBAN:</strong> {{ seller.bank_account_iban }}</p>
                {% endif %}
                {% if seller.bank_account %}
                    <p><strong>Cislo uctu:</strong> {{ seller.bank_account }}</p>
                {% endif %}
                {% if seller.payout_method %}
                    <p><strong>Zpusob vyplaty:</strong> {{ seller.payout_method }}</p>
                {% endif %}
            </div>
        </div>
    </div>

    {% if invoice.description_text %}
    <div class="notes-section">
        <h4>Poznamka</h4>
        <p>{{ invoice.description_text }}</p>
    </div>
    {% endif %}

    <!-- Status -->
    {% if invoice.status %}
    <div style="text-align: center; margin: 20px 0;">
        <span class="status-badge status-{{ invoice.status }}">
            {% if invoice.status == 'draft' %}Koncept
            {% elif invoice.status == 'submitted' %}Odeslano
            {% elif invoice.status == 'approved' %}Schvaleno
            {% elif invoice.status == 'paid' %}Vyplaceno
            {% elif invoice.status == 'rejected' %}Zamitnuto
            {% else %}{{ invoice.status }}
            {% endif %}
        </span>
    </div>
    {% endif %}

    <!-- Footer -->
    <div class="invoice-footer">
        <p>Faktura za provize | {{ platform.company_name or 'Webomat s.r.o.' }}</p>
        <p>Dokument byl vygenerovan elektronicky.</p>
    </div>
</body>
</html>
